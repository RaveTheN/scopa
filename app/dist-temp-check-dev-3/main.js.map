{"version":3,"file":"main.js","mappings":"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","sources":["./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.config.ts","./src/app/app.routes.ts","./src/app/components/ai-suggestion-panel/ai-suggestion-panel.component.ts","./src/app/components/ai-suggestion-panel/ai-suggestion-panel.component.html","./src/app/components/card-cell/card-cell.component.ts","./src/app/components/card-cell/card-cell.component.html","./src/app/components/card-grid/card-grid.component.ts","./src/app/components/card-grid/card-grid.component.html","./src/app/components/hand-selector/hand-selector.component.ts","./src/app/components/hand-selector/hand-selector.component.html","./src/app/components/log-bar/log-bar.component.ts","./src/app/components/log-bar/log-bar.component.html","./src/app/components/stats-panel/stats-panel.component.ts","./src/app/components/stats-panel/stats-panel.component.html","./src/app/components/toolbar/toolbar.component.ts","./src/app/components/toolbar/toolbar.component.html","./src/app/models/card.model.ts","./src/app/services/ai-suggestion.service.ts","./src/app/services/card-tracker.service.ts","./src/app/services/game-state.service.ts","./src/app/services/local-storage.service.ts","./src/app/services/openai.service.ts","./src/app/services/probability.service.ts","./src/app/utils/combinations.util.ts","./src/environments/environment.ts","./src/main.ts"],"sourcesContent":["import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { combineLatest, map } from 'rxjs';\r\nimport { AISuggestionService } from './services/ai-suggestion.service';\nimport { GameStateService } from './services/game-state.service';\nimport { ProbabilityService } from './services/probability.service';\nimport { CardGridComponent } from './components/card-grid/card-grid.component';\nimport { ToolbarComponent } from './components/toolbar/toolbar.component';\nimport { StatsPanelComponent } from './components/stats-panel/stats-panel.component';\nimport { HandSelectorComponent } from './components/hand-selector/hand-selector.component';\nimport { AISuggestionPanelComponent } from './components/ai-suggestion-panel/ai-suggestion-panel.component';\nimport { LogBarComponent } from './components/log-bar/log-bar.component';\nimport { CARD_BY_ID, CardState, GamePhase, GameState } from './models/card.model';\nimport { findCombinations } from './utils/combinations.util';\n\r\ninterface TableViewModel {\r\n  cardStates: Record<string, CardState>;\r\n  probabilities: Record<number, number>;\r\n  selectableCardIds: Set<string>;\r\n  phase: GamePhase;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  standalone: true,\r\n  imports: [\r\n    CommonModule,\r\n    ToolbarComponent,\r\n    StatsPanelComponent,\r\n    CardGridComponent,\r\n    HandSelectorComponent,\r\n    AISuggestionPanelComponent,\r\n    LogBarComponent\r\n  ],\r\n  templateUrl: './app.component.html',\r\n  styleUrls: ['./app.component.scss']\r\n})\r\nexport class AppComponent {\r\n  readonly gamePhase = GamePhase;\r\n  readonly phase$ = this.gameStateService.phase;\r\n\r\n  readonly tableVm$ = combineLatest([\r\n    this.gameStateService.state,\r\n    this.probabilityService.probabilities$\r\n  ]).pipe(\r\n    map(([state, probabilities]): TableViewModel => {\r\n      const probabilityRecord: Record<number, number> = {};\r\n      for (let rank = 1; rank <= 10; rank += 1) {\r\n        probabilityRecord[rank] = probabilities.get(rank) ?? 0;\r\n      }\r\n\r\n      return {\r\n        cardStates: state.cardStates,\r\n        probabilities: probabilityRecord,\r\n        selectableCardIds: this.buildSelectableSet(state),\r\n        phase: state.phase\r\n      };\r\n    })\r\n  );\r\n\r\n  constructor(\r\n    private readonly gameStateService: GameStateService,\r\n    private readonly probabilityService: ProbabilityService,\r\n    private readonly aiSuggestionService: AISuggestionService\r\n  ) {\r\n    void this.aiSuggestionService;\r\n  }\r\n\r\n  onTableCardClicked(cardId: string, phase: GamePhase): void {\r\n    if (phase === GamePhase.CHOOSE_COMBINATION) {\r\n      this.gameStateService.selectCombinationCard(cardId);\r\n      return;\r\n    }\r\n\r\n    this.gameStateService.clickTableCard(cardId);\r\n  }\r\n\r\n  private buildSelectableSet(state: GameState): Set<string> {\n    const selectable = new Set<string>();\n\r\n    if (state.phase === GamePhase.INITIAL_FOUR) {\r\n      for (const [cardId, cardState] of Object.entries(state.cardStates)) {\r\n        if (cardState === CardState.UNKNOWN || cardState === CardState.ON_TABLE) {\r\n          selectable.add(cardId);\r\n        }\r\n      }\r\n      return selectable;\r\n    }\r\n\r\n    if (state.phase === GamePhase.PLAYING) {\n      for (const [cardId, cardState] of Object.entries(state.cardStates)) {\n        if (state.turn === 'ME' && cardState === CardState.IN_MY_HAND) {\n          selectable.add(cardId);\n        }\n\r\n        if (state.turn === 'OPPONENT' && cardState === CardState.UNKNOWN) {\r\n          selectable.add(cardId);\r\n        }\r\n      }\n      return selectable;\n    }\n\n    if (!state.pendingPlayedCard) {\n      return selectable;\n    }\n\n    const pendingCard = CARD_BY_ID[state.pendingPlayedCard];\n    if (!pendingCard) {\n      return selectable;\n    }\n\n    const tableCards = state.cardsOnTable\n      .map((id) => CARD_BY_ID[id])\n      .filter((card) => !!card);\n    const validCombinations = findCombinations(pendingCard.rank, tableCards);\n\n    for (const combination of validCombinations) {\n      for (const card of combination) {\n        selectable.add(card.id);\n      }\n    }\n\n    for (const cardId of state.selectedCombination) {\n      selectable.add(cardId);\n    }\n\n    return selectable;\n  }\n}\n","<div class=\"app-container\">\r\n  <h1>Scopa</h1>\r\n\r\n  <app-toolbar />\r\n\r\n  <app-stats-panel />\r\n\r\n  <div class=\"banner-warning\" *ngIf=\"(phase$ | async) === gamePhase.CHOOSE_COMBINATION\">\r\n    Selezionare combinazione\r\n  </div>\r\n\r\n  <div class=\"main-content\" *ngIf=\"tableVm$ | async as tableVm\">\r\n    <div>\r\n      <h2>Tavolo</h2>\r\n      <app-card-grid\r\n        mode=\"table\"\r\n        [cardStates]=\"tableVm.cardStates\"\r\n        [probabilities]=\"tableVm.probabilities\"\r\n        [selectableCardIds]=\"tableVm.selectableCardIds\"\r\n        [phase]=\"tableVm.phase\"\r\n        (cardClicked)=\"onTableCardClicked($event, tableVm.phase)\"\r\n      />\r\n    </div>\r\n\r\n    <app-hand-selector />\r\n\r\n    <app-ai-suggestion-panel />\r\n  </div>\r\n\r\n  <app-log-bar />\r\n</div>\r\n","import { ApplicationConfig } from '@angular/core';\r\nimport { provideHttpClient } from '@angular/common/http';\r\nimport { provideRouter } from '@angular/router';\r\nimport { routes } from './app.routes';\r\n\r\nexport const appConfig: ApplicationConfig = {\r\n  providers: [\r\n    provideRouter(routes),\r\n    provideHttpClient()\r\n  ]\r\n};\r\n","import { Routes } from '@angular/router';\r\n\r\nexport const routes: Routes = [];\r\n","import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { AISuggestionService } from '../../services/ai-suggestion.service';\r\nimport { GameStateService } from '../../services/game-state.service';\r\n\r\n@Component({\r\n  selector: 'app-ai-suggestion-panel',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  templateUrl: './ai-suggestion-panel.component.html',\r\n  styleUrls: ['./ai-suggestion-panel.component.scss']\r\n})\r\nexport class AISuggestionPanelComponent {\r\n  readonly aiSuggestion$ = this.gameStateService.aiSuggestion;\r\n  readonly aiLoading$ = this.gameStateService.aiLoading;\r\n\r\n  constructor(\r\n    private readonly gameStateService: GameStateService,\r\n    private readonly aiSuggestionService: AISuggestionService\r\n  ) {}\r\n\r\n  get apiConfigured(): boolean {\r\n    return this.aiSuggestionService.isApiConfigured();\r\n  }\r\n\r\n  manualQuery(): void {\r\n    this.aiSuggestionService.manualQuery();\r\n  }\r\n}\r\n","<div class=\"ai-panel\">\n  <div class=\"ai-header\"> Suggerimento AI</div>\n\n  <div class=\"spinner\" *ngIf=\"aiLoading$ | async\"></div>\n\n  <p class=\"api-note\" *ngIf=\"!apiConfigured\">\n    Configura endpoint backend OpenAI in environment.ts\n  </p>\n\n  <div class=\"ai-text\">{{ (aiSuggestion$ | async) || 'Nessun suggerimento disponibile' }}</div>\n\n  <button type=\"button\" class=\"ai-btn\" (click)=\"manualQuery()\">Chiedi suggerimento</button>\n</div>\n","import { CommonModule } from '@angular/common';\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { Card, CardState } from '../../models/card.model';\n\n@Component({\n  selector: 'app-card-cell',\n  standalone: true,\n  imports: [CommonModule],\n  templateUrl: './card-cell.component.html',\n  styleUrls: ['./card-cell.component.scss']\n})\nexport class CardCellComponent {\n  @Input({ required: true }) card!: Card;\n  @Input({ required: true }) state!: CardState;\n  @Input() probability: number | null = null;\n  @Input() mode: 'table' | 'hand' = 'table';\n  @Input() selectable = true;\n  @Input() blockedCapture = false;\n\n  @Output() clicked = new EventEmitter<void>();\n\n  protected readonly cardState = CardState;\n\n  onClick(): void {\n    if (this.state === CardState.PLAYED) {\n      return;\n    }\n\n    if (!this.selectable) {\n      return;\n    }\n\n    this.clicked.emit();\n  }\n\n  get mainText(): string {\n    if (this.state === CardState.PLAYED) {\n      return '\\u2713';\n    }\n\n    return `${this.card.rank}`;\n  }\n\n  get subText(): string {\n    if (this.state === CardState.IN_MY_HAND) {\n      return 'mia';\n    }\n\n    if (this.state === CardState.UNKNOWN && this.mode === 'table' && this.probability !== null) {\n      return `${Math.round(this.probability * 100)}%`;\n    }\n\n    return '';\n  }\n\n  get showSubText(): boolean {\n    if (this.state === CardState.IN_MY_HAND) {\n      return true;\n    }\n\n    return this.state === CardState.UNKNOWN && this.mode === 'table' && this.probability !== null;\n  }\n}\n","<button\r\n  type=\"button\"\r\n  class=\"cell-button\"\r\n  [class.table-mode]=\"mode === 'table'\"\r\n  [class.hand-mode]=\"mode === 'hand'\"\r\n  [class.state-unknown]=\"state === cardState.UNKNOWN\"\r\n  [class.state-in-my-hand]=\"state === cardState.IN_MY_HAND\"\r\n  [class.state-on-table]=\"state === cardState.ON_TABLE\"\r\n  [class.state-on-table-blinking]=\"state === cardState.ON_TABLE_BLINKING\"\n  [class.state-played]=\"state === cardState.PLAYED\"\n  [class.state-combination-candidate]=\"state === cardState.COMBINATION_CANDIDATE\"\n  [class.not-selectable]=\"!selectable && state !== cardState.PLAYED && state !== cardState.ON_TABLE_BLINKING\"\n  [class.blocked-capture]=\"blockedCapture\"\n  (click)=\"onClick()\"\n>\n  <span class=\"cell-main\">{{ mainText }}</span>\r\n  <span\r\n    class=\"cell-sub\"\r\n    [class.sub-mine]=\"state === cardState.IN_MY_HAND\"\r\n    *ngIf=\"showSubText\"\r\n  >\r\n    {{ subText }}\r\n  </span>\r\n</button>\r\n\r\n","import { CommonModule } from '@angular/common';\r\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\r\nimport {\r\n  Card,\r\n  CardState,\r\n  GamePhase,\r\n  RANKS,\r\n  SUITS,\r\n  Suit,\r\n  createCardId\r\n} from '../../models/card.model';\r\nimport { CardCellComponent } from '../card-cell/card-cell.component';\r\n\r\n@Component({\r\n  selector: 'app-card-grid',\r\n  standalone: true,\r\n  imports: [CommonModule, CardCellComponent],\r\n  templateUrl: './card-grid.component.html',\r\n  styleUrls: ['./card-grid.component.scss']\r\n})\r\nexport class CardGridComponent {\n  @Input() mode: 'table' | 'hand' = 'table';\r\n  @Input() cardStates: Record<string, CardState> = {};\r\n  @Input() probabilities: Record<number, number> = {};\r\n  @Input() selectableCardIds: Set<string> = new Set<string>();\r\n  @Input() phase: GamePhase = GamePhase.INITIAL_FOUR;\r\n\r\n  @Output() cardClicked = new EventEmitter<string>();\r\n\r\n  readonly suits: Suit[] = SUITS;\r\n  readonly ranks: number[] = RANKS;\r\n\r\n  protected readonly cardState = CardState;\n  protected readonly gamePhase = GamePhase;\n\r\n  trackByRank(_: number, rank: number): number {\r\n    return rank;\r\n  }\r\n\r\n  trackBySuit(_: number, suit: Suit): Suit {\r\n    return suit;\r\n  }\r\n\r\n  getCard(suit: Suit, rank: number): Card {\r\n    return {\r\n      id: createCardId(suit, rank),\r\n      suit,\r\n      rank\r\n    };\r\n  }\r\n\r\n  getState(cardId: string): CardState {\r\n    return this.cardStates[cardId] ?? CardState.UNKNOWN;\r\n  }\r\n\r\n  getProbability(rank: number): number | null {\r\n    if (this.mode !== 'table') {\r\n      return null;\r\n    }\r\n\r\n    return this.probabilities[rank] ?? 0;\r\n  }\r\n\r\n  isSelectable(cardId: string): boolean {\r\n    return this.selectableCardIds.has(cardId);\r\n  }\r\n\r\n  onCardClick(cardId: string): void {\r\n    this.cardClicked.emit(cardId);\r\n  }\r\n}\r\n","<table class=\"card-grid\">\r\n  <thead>\r\n    <tr>\r\n      <th *ngFor=\"let suit of suits; trackBy: trackBySuit\">{{ suit }}</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let rank of ranks; trackBy: trackByRank\">\r\n      <td *ngFor=\"let suit of suits; trackBy: trackBySuit\">\r\n        <ng-container *ngIf=\"getCard(suit, rank) as card\">\r\n          <app-card-cell\n            [card]=\"card\"\n            [state]=\"getState(card.id)\"\n            [probability]=\"getProbability(rank)\"\n            [mode]=\"mode\"\n            [selectable]=\"isSelectable(card.id)\"\n            [blockedCapture]=\"\n              mode === 'table' &&\n              phase === gamePhase.CHOOSE_COMBINATION &&\n              getState(card.id) === cardState.ON_TABLE &&\n              !isSelectable(card.id)\n            \"\n            (clicked)=\"onCardClick(card.id)\"\n          />\n        </ng-container>\n      </td>\n    </tr>\r\n  </tbody>\r\n</table>\r\n","import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { CardState, GamePhase } from '../../models/card.model';\r\nimport { GameStateService } from '../../services/game-state.service';\r\nimport { CardGridComponent } from '../card-grid/card-grid.component';\r\n\r\ninterface HandViewModel {\r\n  cardStates: Record<string, CardState>;\r\n  myHandCount: number;\r\n  selectableCardIds: Set<string>;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-hand-selector',\r\n  standalone: true,\r\n  imports: [CommonModule, CardGridComponent],\r\n  templateUrl: './hand-selector.component.html',\r\n  styleUrls: ['./hand-selector.component.scss']\r\n})\r\nexport class HandSelectorComponent {\r\n  readonly emptyProbabilities: Record<number, number> = {};\r\n  readonly initialPhase = GamePhase.INITIAL_FOUR;\r\n\r\n  readonly vm$ = this.gameStateService.state.pipe(\r\n    map((state): HandViewModel => {\r\n      const selectableCardIds = new Set<string>();\r\n\r\n      for (const [cardId, cardState] of Object.entries(state.cardStates)) {\r\n        if (cardState === CardState.UNKNOWN || cardState === CardState.IN_MY_HAND) {\r\n          selectableCardIds.add(cardId);\r\n        }\r\n      }\r\n\r\n      return {\r\n        cardStates: state.cardStates,\r\n        myHandCount: state.myHand.length,\r\n        selectableCardIds\r\n      };\r\n    })\r\n  );\r\n\r\n  readonly phase$ = this.gameStateService.phase;\r\n\r\n  constructor(private readonly gameStateService: GameStateService) {}\r\n\r\n  onCardClicked(cardId: string): void {\r\n    this.gameStateService.clickHandCard(cardId);\r\n  }\r\n}\r\n","<div class=\"hand-wrap\" *ngIf=\"vm$ | async as vm\">\r\n  <h2>La mia mano ({{ vm.myHandCount }}/3)</h2>\r\n  <app-card-grid\r\n    mode=\"hand\"\r\n    [cardStates]=\"vm.cardStates\"\r\n    [probabilities]=\"emptyProbabilities\"\r\n    [selectableCardIds]=\"vm.selectableCardIds\"\r\n    [phase]=\"(phase$ | async) ?? initialPhase\"\r\n    (cardClicked)=\"onCardClicked($event)\"\r\n  />\r\n</div>\r\n","import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { GameStateService } from '../../services/game-state.service';\r\n\r\n@Component({\r\n  selector: 'app-log-bar',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  templateUrl: './log-bar.component.html',\r\n  styleUrls: ['./log-bar.component.scss']\r\n})\r\nexport class LogBarComponent {\r\n  readonly logText$ = this.gameStateService.lastPlayLog.pipe(\r\n    map((value) => value || 'Nessuna giocata ancora')\r\n  );\r\n\r\n  constructor(private readonly gameStateService: GameStateService) {}\r\n}\r\n","<div class=\"log-bar\">\r\n  <strong>Ultima giocata:</strong> {{ logText$ | async }}\r\n</div>\r\n","import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { CARD_BY_ID, CardState, GamePhase, Suit } from '../../models/card.model';\r\nimport { GameStateService } from '../../services/game-state.service';\r\n\r\ninterface StatsViewModel {\n  denariPlayed: number;\n  coppePlayed: number;\n  spadePlayed: number;\n  bastoniPlayed: number;\n  totalPlayed: number;\n  remaining: number;\n  myCaptured: number;\n  opponentCaptured: number;\n  phaseLabel: string;\n}\n\r\n@Component({\r\n  selector: 'app-stats-panel',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  templateUrl: './stats-panel.component.html',\r\n  styleUrls: ['./stats-panel.component.scss']\r\n})\r\nexport class StatsPanelComponent {\r\n  readonly stats$ = this.gameStateService.state.pipe(\r\n    map((state): StatsViewModel => {\r\n      const playedIds = Object.entries(state.cardStates)\r\n        .filter(([, cardState]) => cardState === CardState.PLAYED)\r\n        .map(([cardId]) => cardId);\r\n\r\n      const denariPlayed = playedIds\n        .map((cardId) => CARD_BY_ID[cardId])\n        .filter((card) => card?.suit === Suit.Denari)\n        .length;\n      const coppePlayed = playedIds\n        .map((cardId) => CARD_BY_ID[cardId])\n        .filter((card) => card?.suit === Suit.Coppe)\n        .length;\n      const spadePlayed = playedIds\n        .map((cardId) => CARD_BY_ID[cardId])\n        .filter((card) => card?.suit === Suit.Spade)\n        .length;\n      const bastoniPlayed = playedIds\n        .map((cardId) => CARD_BY_ID[cardId])\n        .filter((card) => card?.suit === Suit.Bastoni)\n        .length;\n\n      const totalPlayed = playedIds.length;\n\n      return {\n        denariPlayed,\n        coppePlayed,\n        spadePlayed,\n        bastoniPlayed,\n        totalPlayed,\n        remaining: 40 - totalPlayed,\n        myCaptured: state.myCapturedCards.length,\n        opponentCaptured: state.opponentCapturedCards.length,\n        phaseLabel: this.toPhaseLabel(state.phase)\n      };\n    })\n  );\r\n\r\n  constructor(private readonly gameStateService: GameStateService) {}\r\n\r\n  private toPhaseLabel(phase: GamePhase): string {\r\n    if (phase === GamePhase.INITIAL_FOUR) {\r\n      return 'Carte iniziali';\r\n    }\r\n\r\n    if (phase === GamePhase.PLAYING) {\r\n      return 'In gioco';\r\n    }\r\n\r\n    return 'Scegli combinazione';\r\n  }\r\n}\r\n","<div class=\"stats-row\" *ngIf=\"stats$ | async as stats\">\n  <div>Denari: {{ stats.denariPlayed }}/10</div>\n  <div>Coppe: {{ stats.coppePlayed }}/10</div>\n  <div>Spade: {{ stats.spadePlayed }}/10</div>\n  <div>Bastoni: {{ stats.bastoniPlayed }}/10</div>\n  <div>Totale uscite: {{ stats.totalPlayed }}/40</div>\n  <div>Rimaste: {{ stats.remaining }}</div>\n  <div>Prese tue: {{ stats.myCaptured }}</div>\n  <div>Prese avversario: {{ stats.opponentCaptured }}</div>\n  <div>Fase: {{ stats.phaseLabel }}</div>\n</div>\n","import { CommonModule } from '@angular/common';\r\nimport { Component } from '@angular/core';\r\nimport { map } from 'rxjs';\r\nimport { GameStateService } from '../../services/game-state.service';\r\n\r\n@Component({\r\n  selector: 'app-toolbar',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  templateUrl: './toolbar.component.html',\r\n  styleUrls: ['./toolbar.component.scss']\r\n})\r\nexport class ToolbarComponent {\r\n  readonly opponentCardCount$ = this.gameStateService.opponentCardCount;\r\n  readonly turn$ = this.gameStateService.turn;\r\n  readonly canUndo$ = this.gameStateService.state.pipe(map((state) => state.history.length > 0));\r\n\r\n  constructor(private readonly gameStateService: GameStateService) {}\r\n\r\n  cycleOpponentCards(current: number | null): void {\r\n    if (current === null) {\r\n      return;\r\n    }\r\n\r\n    const next = current === 3 ? 2 : current === 2 ? 1 : 3;\r\n    this.gameStateService.setOpponentCardCount(next);\r\n  }\r\n\r\n  reset(): void {\r\n    const confirmed = window.confirm('Confermi il reset della partita?');\r\n    if (!confirmed) {\r\n      return;\r\n    }\r\n\r\n    this.gameStateService.reset();\r\n  }\r\n\r\n  undo(): void {\r\n    this.gameStateService.undo();\r\n  }\r\n\r\n  setTurn(turn: 'ME' | 'OPPONENT'): void {\r\n    this.gameStateService.setTurn(turn);\r\n  }\r\n}\r\n","<div class=\"toolbar-row\" *ngIf=\"{ opponent: (opponentCardCount$ | async), turn: (turn$ | async), canUndo: (canUndo$ | async) } as vm\">\r\n  <button\r\n    type=\"button\"\r\n    class=\"toolbar-btn\"\r\n    (click)=\"cycleOpponentCards(vm.opponent)\"\r\n  >\r\n    Carte avversario: {{ vm.opponent }}\r\n  </button>\r\n\r\n  <button type=\"button\" class=\"toolbar-btn reset-btn\" (click)=\"reset()\">Reset</button>\r\n\r\n  <button\r\n    type=\"button\"\r\n    class=\"toolbar-btn\"\r\n    [disabled]=\"!vm.canUndo\"\r\n    (click)=\"undo()\"\r\n  >\r\n     Undo\r\n  </button>\r\n\r\n  <button\r\n    type=\"button\"\r\n    class=\"toolbar-btn turn-btn\"\r\n    [class.active]=\"vm.turn === 'ME'\"\r\n    [disabled]=\"vm.turn !== null\"\r\n    (click)=\"setTurn('ME')\"\r\n  >\r\n    Tu\r\n  </button>\r\n\r\n  <button\r\n    type=\"button\"\r\n    class=\"toolbar-btn turn-btn\"\r\n    [class.active]=\"vm.turn === 'OPPONENT'\"\r\n    [disabled]=\"vm.turn !== null\"\r\n    (click)=\"setTurn('OPPONENT')\"\r\n  >\r\n    Avversario\r\n  </button>\r\n</div>\r\n","export enum Suit {\r\n  Denari = 'Denari',\r\n  Coppe = 'Coppe',\r\n  Spade = 'Spade',\r\n  Bastoni = 'Bastoni'\r\n}\r\n\r\nexport enum CardState {\r\n  UNKNOWN = 'UNKNOWN',\r\n  IN_MY_HAND = 'IN_MY_HAND',\r\n  ON_TABLE = 'ON_TABLE',\r\n  ON_TABLE_BLINKING = 'ON_TABLE_BLINKING',\r\n  PLAYED = 'PLAYED',\r\n  COMBINATION_CANDIDATE = 'COMBINATION_CANDIDATE'\r\n}\r\n\r\nexport enum GamePhase {\r\n  INITIAL_FOUR = 'INITIAL_FOUR',\r\n  PLAYING = 'PLAYING',\r\n  CHOOSE_COMBINATION = 'CHOOSE_COMBINATION'\r\n}\r\n\r\nexport type Turn = 'ME' | 'OPPONENT' | null;\r\n\r\nexport interface Card {\r\n  id: string;\r\n  suit: Suit;\r\n  rank: number;\r\n}\r\n\r\nexport interface GameStateSnapshot {\n  cardStates: Record<string, CardState>;\n  phase: GamePhase;\n  turn: Turn;\n  myHand: string[];\n  opponentCardCount: number;\n  cardsOnTable: string[];\n  myCapturedCards: string[];\n  opponentCapturedCards: string[];\n  initialFourCount: number;\n  lastPlayLog: string;\n  pendingPlayedCard: string | null;\n  selectedCombination: string[];\n}\n\r\nexport interface GameState extends GameStateSnapshot {\r\n  history: GameStateSnapshot[];\r\n  aiSuggestion: string;\r\n  aiLoading: boolean;\r\n}\r\n\r\nexport const SUITS: Suit[] = [Suit.Denari, Suit.Coppe, Suit.Spade, Suit.Bastoni];\r\n\r\nexport const RANKS: number[] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];\r\n\r\nexport function createCardId(suit: Suit, rank: number): string {\r\n  return `${suit.toLowerCase()}-${rank}`;\r\n}\r\n\r\nexport const ALL_CARDS: Card[] = SUITS.flatMap((suit) =>\r\n  RANKS.map((rank) => ({\r\n    id: createCardId(suit, rank),\r\n    suit,\r\n    rank\r\n  }))\r\n);\r\n\r\nexport const CARD_BY_ID: Record<string, Card> = ALL_CARDS.reduce<Record<string, Card>>((acc, card) => {\r\n  acc[card.id] = card;\r\n  return acc;\r\n}, {});\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  Observable,\r\n  Subject,\r\n  combineLatest,\r\n  debounceTime,\r\n  distinctUntilChanged,\r\n  filter,\r\n  finalize,\r\n  map,\r\n  of,\r\n  switchMap,\r\n  takeUntil,\r\n  tap,\r\n  catchError\r\n} from 'rxjs';\r\nimport { environment } from '../../environments/environment';\r\nimport {\n  CARD_BY_ID,\n  Card,\n  CardState,\n  GamePhase,\n  GameState\n} from '../models/card.model';\nimport { findCombinations } from '../utils/combinations.util';\nimport { GameStateService } from './game-state.service';\nimport { OpenAIService, OpenAiLegalMove, OpenAiQueryInput } from './openai.service';\nimport { ProbabilityService } from './probability.service';\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AISuggestionService implements OnDestroy {\r\n  private readonly destroy$ = new Subject<void>();\r\n\r\n  private latestState: GameState | null = null;\r\n  private latestProbabilities = new Map<number, number>();\r\n\r\n  constructor(\r\n    private readonly gameStateService: GameStateService,\r\n    private readonly probabilityService: ProbabilityService,\r\n    private readonly openAiService: OpenAIService\r\n  ) {\r\n    combineLatest([\r\n      this.gameStateService.state,\r\n      this.probabilityService.probabilities$\r\n    ]).pipe(\r\n      takeUntil(this.destroy$),\r\n      tap(([state, probabilities]) => {\r\n        this.latestState = state;\r\n        this.latestProbabilities = probabilities;\r\n      }),\r\n      map(([state, probabilities]) => ({\r\n        state,\r\n        probabilities,\r\n        key: this.buildTriggerKey(state, probabilities)\r\n      })),\r\n      distinctUntilChanged((a, b) => a.key === b.key),\r\n      filter(({ state }) =>\r\n        state.turn === 'ME' &&\r\n        state.myHand.length > 0 &&\r\n        state.phase === GamePhase.PLAYING\r\n      ),\r\n      debounceTime(1000),\r\n      switchMap(({ state, probabilities }) => this.executeQuery(state, probabilities))\r\n    ).subscribe();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.destroy$.next();\r\n    this.destroy$.complete();\r\n  }\r\n\r\n  manualQuery(): void {\r\n    const state = this.latestState;\r\n    if (!state) {\r\n      return;\r\n    }\r\n\r\n    this.executeQuery(state, this.latestProbabilities).subscribe();\r\n  }\r\n\r\n  isApiConfigured(): boolean {\n    const endpoint = environment.openaiProxyUrl.trim();\n    return endpoint.length > 0 && endpoint !== 'YOUR_BACKEND_ENDPOINT_HERE';\n  }\n\r\n  private executeQuery(state: GameState, probabilities: Map<number, number>): Observable<void> {\r\n    if (!this.isApiConfigured()) {\n      this.gameStateService.setAiLoading(false);\n      this.gameStateService.setAiSuggestion('Configura endpoint backend OpenAI in environment.ts');\n      return of(void 0);\n    }\n\r\n    if (!(state.turn === 'ME' && state.myHand.length > 0 && state.phase === GamePhase.PLAYING)) {\r\n      this.gameStateService.setAiLoading(false);\r\n      return of(void 0);\r\n    }\r\n\r\n    const input = this.buildQueryInput(state, probabilities);\r\n\r\n    this.gameStateService.setAiLoading(true);\r\n\r\n    return this.openAiService.queryBestMove(input).pipe(\r\n      tap((suggestion) => {\r\n        this.gameStateService.setAiSuggestion(suggestion);\r\n      }),\r\n      catchError(() => {\r\n        this.gameStateService.setAiSuggestion('Errore durante la richiesta a OpenAI.');\r\n        return of('');\r\n      }),\r\n      finalize(() => {\r\n        this.gameStateService.setAiLoading(false);\r\n      }),\r\n      map(() => void 0)\r\n    );\r\n  }\r\n\r\n  private buildQueryInput(state: GameState, probabilities: Map<number, number>): OpenAiQueryInput {\r\n    const probabilitiesByRank: Record<number, number> = {};\r\n    for (let rank = 1; rank <= 10; rank += 1) {\r\n      probabilitiesByRank[rank] = probabilities.get(rank) ?? 0;\r\n    }\r\n\r\n    const playedStates = new Set<CardState>([\r\n      CardState.PLAYED,\r\n      CardState.ON_TABLE,\r\n      CardState.ON_TABLE_BLINKING,\r\n      CardState.COMBINATION_CANDIDATE\r\n    ]);\r\n\r\n    const playedCards = Object.entries(state.cardStates)\n      .filter(([, cardState]) => playedStates.has(cardState))\n      .map(([cardId]) => this.cardLabel(cardId));\n\n    const unknownCardsCount = Object.values(state.cardStates).filter((cardState) => cardState === CardState.UNKNOWN).length;\n    const tableCards = state.cardsOnTable\n      .map((cardId) => CARD_BY_ID[cardId])\n      .filter((card): card is Card => !!card);\n\n    return {\n      myHand: state.myHand.map((cardId) => this.cardLabel(cardId)),\n      cardsOnTable: state.cardsOnTable.map((cardId) => this.cardLabel(cardId)),\n      playedCards,\n      unknownCardsCount,\n      probabilitiesByRank,\n      opponentCardCount: state.opponentCardCount,\n      legalMoves: state.myHand\n        .map((cardId) => this.buildLegalMove(cardId, tableCards))\n        .filter((move): move is OpenAiLegalMove => !!move)\n    };\n  }\n\r\n  private buildTriggerKey(state: GameState, probabilities: Map<number, number>): string {\r\n    const probabilityVector = Array.from({ length: 10 }, (_, index) => probabilities.get(index + 1) ?? 0);\r\n\r\n    return JSON.stringify({\r\n      cardStates: state.cardStates,\r\n      phase: state.phase,\r\n      turn: state.turn,\r\n      myHand: state.myHand,\r\n      cardsOnTable: state.cardsOnTable,\r\n      opponentCardCount: state.opponentCardCount,\r\n      pendingPlayedCard: state.pendingPlayedCard,\r\n      selectedCombination: state.selectedCombination,\r\n      probabilityVector\r\n    });\r\n  }\r\n\r\n  private cardLabel(cardId: string): string {\n    const card = CARD_BY_ID[cardId];\n    if (!card) {\n      return cardId;\n    }\n\r\n    return `${this.rankLabel(card.rank)} di ${card.suit}`;\r\n  }\r\n\r\n  private rankLabel(rank: number): string {\r\n    if (rank === 1) {\r\n      return 'Asso';\r\n    }\r\n    if (rank === 8) {\r\n      return 'Donna';\r\n    }\r\n    if (rank === 9) {\r\n      return 'Cavallo';\r\n    }\r\n    if (rank === 10) {\r\n      return 'Re';\r\n    }\n    return rank.toString();\n  }\n\n  private buildLegalMove(cardId: string, tableCards: Card[]): OpenAiLegalMove | null {\n    const playedCard = CARD_BY_ID[cardId];\n    if (!playedCard) {\n      return null;\n    }\n\n    const captures = findCombinations(playedCard.rank, tableCards)\n      .map((combination) => combination.map((card) => this.cardLabel(card.id)));\n\n    return {\n      card: this.cardLabel(playedCard.id),\n      captures\n    };\n  }\n}\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  CARD_BY_ID,\r\n  Card,\r\n  CardState,\r\n  GamePhase,\r\n  GameStateSnapshot,\r\n  Turn\r\n} from '../models/card.model';\r\nimport { findCombinations } from '../utils/combinations.util';\r\n\r\nexport interface TrackerResult {\r\n  error: string | null;\r\n  shouldToggleTurn: boolean;\r\n  shouldDecrementOpponent: boolean;\r\n  didMutate: boolean;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CardTrackerService {\r\n  handleTableCardClick(snapshot: GameStateSnapshot, cardId: string): TrackerResult {\r\n    const card = CARD_BY_ID[cardId];\r\n    if (!card) {\r\n      return this.errorResult('Carta non valida');\r\n    }\r\n\r\n    if (snapshot.phase === GamePhase.INITIAL_FOUR) {\r\n      const didMutate = this.handleInitialFour(snapshot, cardId);\r\n      return this.okResult(didMutate);\r\n    }\r\n\r\n    if (snapshot.phase !== GamePhase.PLAYING) {\r\n      return this.errorResult('Seleziona una combinazione valida');\r\n    }\r\n\r\n    if (snapshot.turn === null) {\r\n      return this.errorResult('Seleziona chi gioca per primo');\r\n    }\r\n\r\n    const cardState = snapshot.cardStates[cardId];\r\n    if (snapshot.turn === 'ME') {\r\n      if (cardState !== CardState.IN_MY_HAND) {\r\n        return this.errorResult('Questa carta non e nella tua mano');\r\n      }\r\n    } else if (cardState !== CardState.UNKNOWN) {\r\n      return this.errorResult('Carta non selezionabile per l\\'avversario');\r\n    }\r\n\r\n    return this.handlePlay(snapshot, card);\r\n  }\r\n\r\n  handleCombinationSelection(snapshot: GameStateSnapshot, cardId: string): TrackerResult {\r\n    if (snapshot.phase !== GamePhase.CHOOSE_COMBINATION || !snapshot.pendingPlayedCard) {\r\n      return this.errorResult('Nessuna combinazione da selezionare');\r\n    }\r\n\r\n    const state = snapshot.cardStates[cardId];\r\n    if (state !== CardState.ON_TABLE && state !== CardState.COMBINATION_CANDIDATE) {\r\n      return this.errorResult('Carta non selezionabile per la combinazione');\r\n    }\r\n\r\n    if (state === CardState.ON_TABLE) {\r\n      snapshot.cardStates[cardId] = CardState.COMBINATION_CANDIDATE;\r\n      if (!snapshot.selectedCombination.includes(cardId)) {\r\n        snapshot.selectedCombination = [...snapshot.selectedCombination, cardId];\r\n      }\r\n    } else {\r\n      snapshot.cardStates[cardId] = CardState.ON_TABLE;\r\n      snapshot.selectedCombination = snapshot.selectedCombination.filter((id) => id !== cardId);\r\n    }\r\n\r\n    const pending = CARD_BY_ID[snapshot.pendingPlayedCard];\r\n    if (!pending) {\r\n      return this.errorResult('Carta giocata in attesa non valida');\r\n    }\r\n\r\n    const selectedCards = snapshot.selectedCombination\r\n      .map((id) => CARD_BY_ID[id])\r\n      .filter((card): card is Card => !!card);\r\n    const selectedSum = selectedCards.reduce((acc, card) => acc + card.rank, 0);\r\n\r\n    const tableCards = snapshot.cardsOnTable\r\n      .map((id) => CARD_BY_ID[id])\r\n      .filter((tableCard): tableCard is Card => !!tableCard);\r\n    const validCombinations = findCombinations(pending.rank, tableCards);\r\n\r\n    const isValidSelection = this.matchesAnyCombination(snapshot.selectedCombination, validCombinations);\r\n\r\n    if (selectedSum !== pending.rank || !isValidSelection) {\r\n      return this.okResult(true);\r\n    }\r\n\r\n    for (const selectedId of snapshot.selectedCombination) {\r\n      snapshot.cardStates[selectedId] = CardState.PLAYED;\r\n    }\r\n\r\n    snapshot.cardStates[snapshot.pendingPlayedCard] = CardState.PLAYED;\n    snapshot.cardsOnTable = snapshot.cardsOnTable.filter((id) => !snapshot.selectedCombination.includes(id));\n    this.recordCapture(\n      snapshot,\n      snapshot.turn === 'ME',\n      snapshot.pendingPlayedCard,\n      snapshot.selectedCombination\n    );\n\r\n    const actor = this.actorLabel(snapshot.turn);\r\n    const selectedLabel = snapshot.selectedCombination\r\n      .map((id) => CARD_BY_ID[id])\r\n      .filter((card): card is Card => !!card)\r\n      .map((card) => this.cardLabel(card))\r\n      .join(', ');\r\n    snapshot.lastPlayLog = `${actor} gioca ${this.cardLabel(pending)}, prende ${selectedLabel}`;\r\n\r\n    if (snapshot.myHand.includes(snapshot.pendingPlayedCard)) {\r\n      snapshot.myHand = snapshot.myHand.filter((id) => id !== snapshot.pendingPlayedCard);\r\n    }\r\n\r\n    snapshot.pendingPlayedCard = null;\r\n    snapshot.selectedCombination = [];\r\n    snapshot.phase = GamePhase.PLAYING;\r\n\r\n    return {\r\n      error: null,\r\n      shouldToggleTurn: true,\r\n      shouldDecrementOpponent: false,\r\n      didMutate: true\r\n    };\r\n  }\r\n\r\n  private handleInitialFour(snapshot: GameStateSnapshot, cardId: string): boolean {\r\n    const current = snapshot.cardStates[cardId];\r\n\r\n    if (current === CardState.UNKNOWN) {\r\n      snapshot.cardStates[cardId] = CardState.ON_TABLE;\r\n      if (!snapshot.cardsOnTable.includes(cardId)) {\r\n        snapshot.cardsOnTable = [...snapshot.cardsOnTable, cardId];\r\n      }\r\n      snapshot.initialFourCount += 1;\r\n      snapshot.phase = snapshot.initialFourCount >= 4 ? GamePhase.PLAYING : GamePhase.INITIAL_FOUR;\r\n      return true;\r\n    }\r\n\r\n    if (current === CardState.ON_TABLE) {\r\n      snapshot.cardStates[cardId] = CardState.UNKNOWN;\r\n      snapshot.cardsOnTable = snapshot.cardsOnTable.filter((id) => id !== cardId);\r\n      snapshot.initialFourCount = Math.max(0, snapshot.initialFourCount - 1);\r\n      snapshot.phase = snapshot.initialFourCount >= 4 ? GamePhase.PLAYING : GamePhase.INITIAL_FOUR;\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  private handlePlay(snapshot: GameStateSnapshot, playedCard: Card): TrackerResult {\r\n    const actor = this.actorLabel(snapshot.turn);\r\n    const isMyPlay = snapshot.turn === 'ME';\r\n\r\n    const tableCards = snapshot.cardsOnTable\r\n      .map((id) => CARD_BY_ID[id])\r\n      .filter((card): card is Card => !!card);\r\n\r\n    const combinations = findCombinations(playedCard.rank, tableCards);\r\n\r\n    if (combinations.length === 0) {\r\n      snapshot.cardStates[playedCard.id] = CardState.ON_TABLE;\r\n      if (!snapshot.cardsOnTable.includes(playedCard.id)) {\r\n        snapshot.cardsOnTable = [...snapshot.cardsOnTable, playedCard.id];\r\n      }\r\n      if (isMyPlay) {\r\n        snapshot.myHand = snapshot.myHand.filter((id) => id !== playedCard.id);\r\n      }\r\n\r\n      snapshot.lastPlayLog = `${actor} gioca ${this.cardLabel(playedCard)}, nessuna presa`;\r\n      return {\r\n        error: null,\r\n        shouldToggleTurn: true,\r\n        shouldDecrementOpponent: snapshot.turn === 'OPPONENT',\r\n        didMutate: true\r\n      };\r\n    }\r\n\r\n    if (combinations.length === 1) {\r\n      const combo = combinations[0];\r\n      const comboIds = combo.map((card) => card.id);\r\n\r\n      for (const comboId of comboIds) {\r\n        snapshot.cardStates[comboId] = CardState.PLAYED;\r\n      }\r\n      snapshot.cardStates[playedCard.id] = CardState.PLAYED;\n      snapshot.cardsOnTable = snapshot.cardsOnTable.filter((id) => !comboIds.includes(id));\n      this.recordCapture(snapshot, isMyPlay, playedCard.id, comboIds);\n\r\n      if (isMyPlay) {\r\n        snapshot.myHand = snapshot.myHand.filter((id) => id !== playedCard.id);\r\n      }\r\n\r\n      const capturedLabel = combo.map((card) => this.cardLabel(card)).join(', ');\r\n      snapshot.lastPlayLog = `${actor} gioca ${this.cardLabel(playedCard)}, prende ${capturedLabel}`;\r\n      return {\r\n        error: null,\r\n        shouldToggleTurn: true,\r\n        shouldDecrementOpponent: snapshot.turn === 'OPPONENT',\r\n        didMutate: true\r\n      };\r\n    }\r\n\r\n    snapshot.phase = GamePhase.CHOOSE_COMBINATION;\r\n    snapshot.cardStates[playedCard.id] = CardState.ON_TABLE_BLINKING;\r\n    snapshot.pendingPlayedCard = playedCard.id;\r\n    snapshot.selectedCombination = [];\r\n    snapshot.lastPlayLog = `${actor} gioca ${this.cardLabel(playedCard)}, selezionare combinazione`;\r\n\r\n    return {\r\n      error: null,\r\n      shouldToggleTurn: false,\r\n      shouldDecrementOpponent: snapshot.turn === 'OPPONENT',\r\n      didMutate: true\r\n    };\r\n  }\r\n\r\n  private matchesAnyCombination(selectedIds: string[], combinations: Card[][]): boolean {\n    if (selectedIds.length === 0) {\r\n      return false;\r\n    }\r\n\r\n    const selectedKey = [...selectedIds].sort().join('|');\r\n\r\n    return combinations.some((combination) => {\r\n      const comboKey = combination\r\n        .map((card) => card.id)\r\n        .sort()\r\n        .join('|');\r\n      return comboKey === selectedKey;\r\n    });\r\n  }\r\n\r\n  private actorLabel(turn: Turn): string {\n    return turn === 'ME' ? 'Tu' : 'Avversario';\n  }\n\n  private recordCapture(\n    snapshot: GameStateSnapshot,\n    isMyPlay: boolean,\n    playedCardId: string,\n    capturedIds: string[]\n  ): void {\n    const target = isMyPlay ? snapshot.myCapturedCards : snapshot.opponentCapturedCards;\n    const merged = [...target, playedCardId, ...capturedIds];\n    const unique = [...new Set(merged)];\n\n    if (isMyPlay) {\n      snapshot.myCapturedCards = unique;\n      return;\n    }\n\n    snapshot.opponentCapturedCards = unique;\n  }\n\n  private cardLabel(card: Card): string {\n    return `${this.rankLabel(card.rank)} di ${card.suit}`;\n  }\n\r\n  private rankLabel(rank: number): string {\r\n    if (rank === 1) {\r\n      return 'Asso';\r\n    }\r\n    if (rank === 8) {\r\n      return 'Donna';\r\n    }\r\n    if (rank === 9) {\r\n      return 'Cavallo';\r\n    }\r\n    if (rank === 10) {\r\n      return 'Re';\r\n    }\r\n    return rank.toString();\r\n  }\r\n\r\n  private errorResult(message: string): TrackerResult {\r\n    return {\r\n      error: message,\r\n      shouldToggleTurn: false,\r\n      shouldDecrementOpponent: false,\r\n      didMutate: false\r\n    };\r\n  }\r\n\r\n  private okResult(didMutate: boolean): TrackerResult {\r\n    return {\r\n      error: null,\r\n      shouldToggleTurn: false,\r\n      shouldDecrementOpponent: false,\r\n      didMutate\r\n    };\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable, map } from 'rxjs';\r\nimport {\r\n  ALL_CARDS,\r\n  CARD_BY_ID,\r\n  CardState,\r\n  GamePhase,\r\n  GameState,\r\n  GameStateSnapshot,\r\n  Turn\r\n} from '../models/card.model';\r\nimport { CardTrackerService } from './card-tracker.service';\r\nimport { LocalStorageService } from './local-storage.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GameStateService {\r\n  private readonly storageKey = 'state';\r\n  private readonly stateSubject = new BehaviorSubject<GameState>(this.createInitialState());\r\n\r\n  readonly state: Observable<GameState> = this.stateSubject.asObservable();\r\n  readonly cardStates = this.state.pipe(map((state) => state.cardStates));\r\n  readonly phase = this.state.pipe(map((state) => state.phase));\r\n  readonly turn = this.state.pipe(map((state) => state.turn));\r\n  readonly myHand = this.state.pipe(map((state) => state.myHand));\n  readonly opponentCardCount = this.state.pipe(map((state) => state.opponentCardCount));\n  readonly cardsOnTable = this.state.pipe(map((state) => state.cardsOnTable));\n  readonly myCapturedCards = this.state.pipe(map((state) => state.myCapturedCards));\n  readonly opponentCapturedCards = this.state.pipe(map((state) => state.opponentCapturedCards));\n  readonly lastPlayLog = this.state.pipe(map((state) => state.lastPlayLog));\n  readonly aiSuggestion = this.state.pipe(map((state) => state.aiSuggestion));\n  readonly aiLoading = this.state.pipe(map((state) => state.aiLoading));\n\r\n  constructor(\r\n    private readonly cardTracker: CardTrackerService,\r\n    private readonly localStorageService: LocalStorageService\r\n  ) {\r\n    this.stateSubject.next(this.restoreState());\r\n  }\r\n\r\n  getCurrentState(): GameState {\r\n    return this.stateSubject.value;\r\n  }\r\n\r\n  reset(): void {\r\n    const next = this.createInitialState();\r\n    this.commit(next);\r\n  }\r\n\r\n  undo(): void {\r\n    const current = this.stateSubject.value;\r\n    if (current.history.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const previous = current.history[current.history.length - 1];\r\n    const restored = this.cloneSnapshot(previous);\r\n\r\n    const next: GameState = {\r\n      ...restored,\r\n      history: current.history.slice(0, -1).map((snapshot) => this.cloneSnapshot(snapshot)),\r\n      aiSuggestion: current.aiSuggestion,\r\n      aiLoading: current.aiLoading\r\n    };\r\n\r\n    this.commit(next);\r\n  }\r\n\r\n  setTurn(turn: Exclude<Turn, null>): void {\n    this.applyMutation((draft) => {\n      if (draft.turn !== null) {\n        return false;\n      }\n\n      this.setTurnWithOpponentRefill(draft, turn);\n      return true;\n    });\n  }\n\r\n  toggleTurn(): void {\n    this.applyMutation((draft) => {\n      if (draft.turn === null) {\n        return false;\n      }\n\n      const nextTurn = draft.turn === 'ME' ? 'OPPONENT' : 'ME';\n      this.setTurnWithOpponentRefill(draft, nextTurn);\n      return true;\n    });\n  }\n\r\n  clickTableCard(cardId: string): string | null {\r\n    let error: string | null = null;\r\n\r\n    this.applyMutation((draft) => {\r\n      const result = this.cardTracker.handleTableCardClick(draft, cardId);\r\n      if (result.error) {\r\n        error = result.error;\r\n        return false;\r\n      }\r\n\r\n      if (!result.didMutate) {\r\n        return false;\r\n      }\r\n\r\n      if (result.shouldDecrementOpponent) {\r\n        draft.opponentCardCount = Math.max(0, draft.opponentCardCount - 1);\r\n      }\r\n\r\n      if (result.shouldToggleTurn) {\n        const nextTurn = draft.turn === 'ME' ? 'OPPONENT' : 'ME';\n        this.setTurnWithOpponentRefill(draft, nextTurn);\n      }\n\r\n      return true;\r\n    });\r\n\r\n    return error;\r\n  }\r\n\r\n  clickHandCard(cardId: string): void {\r\n    this.applyMutation((draft) => {\r\n      const current = draft.cardStates[cardId];\r\n      if (!current) {\r\n        return false;\r\n      }\r\n\r\n      if (current === CardState.PLAYED || current === CardState.ON_TABLE || current === CardState.ON_TABLE_BLINKING || current === CardState.COMBINATION_CANDIDATE) {\r\n        return false;\r\n      }\r\n\r\n      if (current === CardState.IN_MY_HAND) {\r\n        draft.cardStates[cardId] = CardState.UNKNOWN;\r\n        draft.myHand = draft.myHand.filter((id) => id !== cardId);\r\n        return true;\r\n      }\r\n\r\n      if (current === CardState.UNKNOWN && draft.myHand.length < 3) {\r\n        draft.cardStates[cardId] = CardState.IN_MY_HAND;\r\n        draft.myHand = [...draft.myHand, cardId];\r\n        return true;\r\n      }\r\n\r\n      return false;\r\n    });\r\n  }\r\n\r\n  selectCombinationCard(cardId: string): string | null {\r\n    let error: string | null = null;\r\n\r\n    this.applyMutation((draft) => {\r\n      const result = this.cardTracker.handleCombinationSelection(draft, cardId);\r\n      if (result.error) {\r\n        error = result.error;\r\n        return false;\r\n      }\r\n\r\n      if (!result.didMutate) {\r\n        return false;\r\n      }\r\n\r\n      if (result.shouldToggleTurn) {\n        const nextTurn = draft.turn === 'ME' ? 'OPPONENT' : 'ME';\n        this.setTurnWithOpponentRefill(draft, nextTurn);\n      }\n\r\n      return true;\r\n    });\r\n\r\n    return error;\r\n  }\r\n\r\n  setOpponentCardCount(value: number): void {\r\n    const nextValue = this.clamp(Math.round(value), 0, 3);\r\n\r\n    this.applyMutation((draft) => {\r\n      if (draft.opponentCardCount === nextValue) {\r\n        return false;\r\n      }\r\n\r\n      draft.opponentCardCount = nextValue;\r\n      return true;\r\n    });\r\n  }\r\n\r\n  decrementOpponentCards(): void {\r\n    this.applyMutation((draft) => {\r\n      const next = Math.max(0, draft.opponentCardCount - 1);\r\n      if (next === draft.opponentCardCount) {\r\n        return false;\r\n      }\r\n\r\n      draft.opponentCardCount = next;\r\n      return true;\r\n    });\r\n  }\r\n\r\n  setAiSuggestion(suggestion: string): void {\r\n    this.applyMutation((draft) => {\r\n      if (draft.aiSuggestion === suggestion) {\r\n        return false;\r\n      }\r\n\r\n      draft.aiSuggestion = suggestion;\r\n      return true;\r\n    });\r\n  }\r\n\r\n  setAiLoading(loading: boolean): void {\r\n    this.applyMutation((draft) => {\r\n      if (draft.aiLoading === loading) {\r\n        return false;\r\n      }\r\n\r\n      draft.aiLoading = loading;\r\n      return true;\r\n    });\r\n  }\r\n\r\n  private applyMutation(mutator: (draft: GameState) => boolean): void {\r\n    const current = this.stateSubject.value;\r\n    const draft = this.cloneState(current);\r\n    const didMutate = mutator(draft);\r\n\r\n    if (!didMutate) {\r\n      return;\r\n    }\r\n\r\n    draft.history.push(this.cloneSnapshot(this.toSnapshot(current)));\r\n    this.commit(draft);\r\n  }\r\n\r\n  private commit(state: GameState): void {\r\n    this.stateSubject.next(state);\r\n    this.localStorageService.save(this.storageKey, state);\r\n  }\r\n\r\n  private restoreState(): GameState {\r\n    const loaded = this.localStorageService.load<Partial<GameState>>(this.storageKey);\r\n    if (!loaded) {\r\n      return this.createInitialState();\r\n    }\r\n\r\n    return this.normalizeState(loaded);\r\n  }\r\n\r\n  private normalizeState(raw: Partial<GameState>): GameState {\r\n    const snapshot = this.normalizeSnapshot(raw);\r\n    const historyRaw = Array.isArray(raw.history) ? raw.history : [];\r\n    const history = historyRaw.map((item) => this.normalizeSnapshot(item));\r\n\r\n    return {\r\n      ...snapshot,\r\n      history,\r\n      aiSuggestion: typeof raw.aiSuggestion === 'string' ? raw.aiSuggestion : '',\r\n      aiLoading: typeof raw.aiLoading === 'boolean' ? raw.aiLoading : false\r\n    };\r\n  }\r\n\r\n  private normalizeSnapshot(raw: Partial<GameStateSnapshot>): GameStateSnapshot {\n    const initial = this.createInitialSnapshot();\r\n    const cardStates: Record<string, CardState> = {};\r\n    const validStates = new Set(Object.values(CardState));\r\n\r\n    for (const card of ALL_CARDS) {\r\n      const value = raw.cardStates?.[card.id];\r\n      cardStates[card.id] = validStates.has(value as CardState)\r\n        ? (value as CardState)\r\n        : CardState.UNKNOWN;\r\n    }\r\n\r\n    const phaseValues = new Set(Object.values(GamePhase));\r\n    const phase = phaseValues.has(raw.phase as GamePhase)\r\n      ? (raw.phase as GamePhase)\r\n      : GamePhase.INITIAL_FOUR;\r\n\r\n    const turn = raw.turn === 'ME' || raw.turn === 'OPPONENT' ? raw.turn : null;\r\n\r\n    const myHand = this.uniqueIds(Array.isArray(raw.myHand) ? raw.myHand : []).filter((id) => id in CARD_BY_ID).slice(0, 3);\n    const cardsOnTable = this.uniqueIds(Array.isArray(raw.cardsOnTable) ? raw.cardsOnTable : []).filter((id) => id in CARD_BY_ID);\n    const myCapturedCards = this.uniqueIds(Array.isArray(raw.myCapturedCards) ? raw.myCapturedCards : []).filter((id) => id in CARD_BY_ID);\n    const opponentCapturedCards = this.uniqueIds(Array.isArray(raw.opponentCapturedCards) ? raw.opponentCapturedCards : []).filter((id) => id in CARD_BY_ID);\n    const selectedCombination = this.uniqueIds(Array.isArray(raw.selectedCombination) ? raw.selectedCombination : []).filter((id) => id in CARD_BY_ID);\n\r\n    for (const id of myHand) {\r\n      if (cardStates[id] === CardState.UNKNOWN) {\r\n        cardStates[id] = CardState.IN_MY_HAND;\r\n      }\r\n    }\r\n\r\n    for (const id of cardsOnTable) {\r\n      if (cardStates[id] === CardState.UNKNOWN) {\r\n        cardStates[id] = CardState.ON_TABLE;\r\n      }\r\n    }\r\n\r\n    const pendingPlayedCard = typeof raw.pendingPlayedCard === 'string' && raw.pendingPlayedCard in CARD_BY_ID\r\n      ? raw.pendingPlayedCard\r\n      : null;\r\n\r\n    if (pendingPlayedCard && cardStates[pendingPlayedCard] === CardState.UNKNOWN) {\r\n      cardStates[pendingPlayedCard] = CardState.ON_TABLE_BLINKING;\r\n    }\r\n\r\n    for (const id of selectedCombination) {\r\n      if (cardStates[id] === CardState.ON_TABLE) {\r\n        cardStates[id] = CardState.COMBINATION_CANDIDATE;\r\n      }\r\n    }\r\n\r\n    return {\r\n      ...initial,\r\n      cardStates,\r\n      phase,\r\n      turn,\r\n      myHand,\r\n      opponentCardCount: this.clamp(\r\n        typeof raw.opponentCardCount === 'number' ? Math.round(raw.opponentCardCount) : 3,\r\n        0,\r\n        3\r\n      ),\n      cardsOnTable,\n      myCapturedCards,\n      opponentCapturedCards,\n      initialFourCount: this.clamp(\n        typeof raw.initialFourCount === 'number' ? Math.round(raw.initialFourCount) : cardsOnTable.length,\n        0,\n        4\r\n      ),\r\n      lastPlayLog: typeof raw.lastPlayLog === 'string' ? raw.lastPlayLog : '',\r\n      pendingPlayedCard,\r\n      selectedCombination\r\n    };\r\n  }\r\n\r\n  private createInitialState(): GameState {\r\n    return {\r\n      ...this.createInitialSnapshot(),\r\n      history: [],\r\n      aiSuggestion: '',\r\n      aiLoading: false\r\n    };\r\n  }\r\n\r\n  private createInitialSnapshot(): GameStateSnapshot {\r\n    const cardStates: Record<string, CardState> = {};\r\n\r\n    for (const card of ALL_CARDS) {\r\n      cardStates[card.id] = CardState.UNKNOWN;\r\n    }\r\n\r\n    return {\r\n      cardStates,\r\n      phase: GamePhase.INITIAL_FOUR,\r\n      turn: null,\n      myHand: [],\n      opponentCardCount: 3,\n      cardsOnTable: [],\n      myCapturedCards: [],\n      opponentCapturedCards: [],\n      initialFourCount: 0,\n      lastPlayLog: '',\n      pendingPlayedCard: null,\n      selectedCombination: []\r\n    };\r\n  }\r\n\r\n  private toSnapshot(state: GameState): GameStateSnapshot {\r\n    return {\r\n      cardStates: { ...state.cardStates },\r\n      phase: state.phase,\r\n      turn: state.turn,\n      myHand: [...state.myHand],\n      opponentCardCount: state.opponentCardCount,\n      cardsOnTable: [...state.cardsOnTable],\n      myCapturedCards: [...state.myCapturedCards],\n      opponentCapturedCards: [...state.opponentCapturedCards],\n      initialFourCount: state.initialFourCount,\n      lastPlayLog: state.lastPlayLog,\n      pendingPlayedCard: state.pendingPlayedCard,\n      selectedCombination: [...state.selectedCombination]\r\n    };\r\n  }\r\n\r\n  private cloneSnapshot(snapshot: GameStateSnapshot): GameStateSnapshot {\r\n    return {\r\n      cardStates: { ...snapshot.cardStates },\r\n      phase: snapshot.phase,\r\n      turn: snapshot.turn,\n      myHand: [...snapshot.myHand],\n      opponentCardCount: snapshot.opponentCardCount,\n      cardsOnTable: [...snapshot.cardsOnTable],\n      myCapturedCards: [...snapshot.myCapturedCards],\n      opponentCapturedCards: [...snapshot.opponentCapturedCards],\n      initialFourCount: snapshot.initialFourCount,\n      lastPlayLog: snapshot.lastPlayLog,\n      pendingPlayedCard: snapshot.pendingPlayedCard,\n      selectedCombination: [...snapshot.selectedCombination]\r\n    };\r\n  }\r\n\r\n  private cloneState(state: GameState): GameState {\r\n    return {\r\n      ...this.cloneSnapshot(state),\r\n      history: state.history.map((snapshot) => this.cloneSnapshot(snapshot)),\r\n      aiSuggestion: state.aiSuggestion,\r\n      aiLoading: state.aiLoading\r\n    };\r\n  }\r\n\r\n  private uniqueIds(ids: string[]): string[] {\n    return [...new Set(ids)];\n  }\n\n  private setTurnWithOpponentRefill(draft: GameState, turn: Exclude<Turn, null>): void {\n    const previousTurn = draft.turn;\n    draft.turn = turn;\n\n    const isHandRefillTurnChange = previousTurn === 'ME' && turn === 'OPPONENT';\n    if (isHandRefillTurnChange && draft.opponentCardCount === 0) {\n      draft.opponentCardCount = 3;\n    }\n  }\n\n  private clamp(value: number, min: number, max: number): number {\n    return Math.max(min, Math.min(max, value));\n  }\n}\n\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class LocalStorageService {\r\n  private readonly prefix = 'scopa_ng_';\r\n\r\n  save<T>(key: string, data: T): void {\r\n    try {\r\n      localStorage.setItem(this.buildKey(key), JSON.stringify(data));\r\n    } catch {\r\n      // Storage may be unavailable, fail silently.\r\n    }\r\n  }\r\n\r\n  load<T>(key: string): T | null {\r\n    try {\r\n      const raw = localStorage.getItem(this.buildKey(key));\r\n      if (!raw) {\r\n        return null;\r\n      }\r\n\r\n      return JSON.parse(raw) as T;\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  remove(key: string): void {\r\n    try {\r\n      localStorage.removeItem(this.buildKey(key));\r\n    } catch {\r\n      // Storage may be unavailable, fail silently.\r\n    }\r\n  }\r\n\r\n  private buildKey(key: string): string {\r\n    return `${this.prefix}${key}`;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { map, Observable } from 'rxjs';\nimport { environment } from '../../environments/environment';\n\r\nexport interface OpenAiQueryInput {\n  myHand: string[];\n  cardsOnTable: string[];\n  playedCards: string[];\n  unknownCardsCount: number;\n  probabilitiesByRank: Record<number, number>;\n  opponentCardCount: number;\n  legalMoves: OpenAiLegalMove[];\n}\n\nexport interface OpenAiLegalMove {\n  card: string;\n  captures: string[][];\n}\n\r\ninterface SuggestionResponse {\n  suggestion?: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class OpenAIService {\n  private readonly endpoint = environment.openaiProxyUrl;\n\n  constructor(private readonly http: HttpClient) {}\n\n  queryBestMove(input: OpenAiQueryInput): Observable<string> {\n    return this.http.post<SuggestionResponse>(\n      this.endpoint,\n      input\n    ).pipe(\n      map((response) => response.suggestion?.trim() || 'Nessun suggerimento disponibile.')\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\r\nimport { Observable, combineLatest, map, shareReplay } from 'rxjs';\r\nimport { CARD_BY_ID, CardState, RANKS } from '../models/card.model';\r\nimport { GameStateService } from './game-state.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ProbabilityService {\r\n  readonly probabilities$: Observable<Map<number, number>>;\r\n\r\n  constructor(private readonly gameStateService: GameStateService) {\r\n    this.probabilities$ = combineLatest([\r\n      this.gameStateService.cardStates,\r\n      this.gameStateService.opponentCardCount\r\n    ]).pipe(\r\n      map(([cardStates, opponentCardCount]) => this.computeProbabilities(cardStates, opponentCardCount)),\r\n      shareReplay({ bufferSize: 1, refCount: true })\r\n    );\r\n  }\r\n\r\n  private computeProbabilities(\r\n    cardStates: Record<string, CardState>,\r\n    opponentCardCount: number\r\n  ): Map<number, number> {\r\n    const unknownByRank = new Map<number, number>();\r\n    for (const rank of RANKS) {\r\n      unknownByRank.set(rank, 0);\r\n    }\r\n\r\n    let totalUnknown = 0;\r\n\r\n    for (const [cardId, state] of Object.entries(cardStates)) {\r\n      if (state !== CardState.UNKNOWN) {\r\n        continue;\r\n      }\r\n\r\n      const card = CARD_BY_ID[cardId];\r\n      if (!card) {\r\n        continue;\r\n      }\r\n\r\n      totalUnknown += 1;\r\n      unknownByRank.set(card.rank, (unknownByRank.get(card.rank) ?? 0) + 1);\r\n    }\r\n\r\n    const result = new Map<number, number>();\r\n\r\n    if (opponentCardCount <= 0 || totalUnknown <= 0) {\r\n      for (const rank of RANKS) {\r\n        result.set(rank, 0);\r\n      }\r\n      return result;\r\n    }\r\n\r\n    const drawSize = Math.min(opponentCardCount, totalUnknown);\r\n\r\n    for (const rank of RANKS) {\r\n      const unknownOfRank = unknownByRank.get(rank) ?? 0;\r\n      if (unknownOfRank <= 0) {\r\n        result.set(rank, 0);\r\n        continue;\r\n      }\r\n\r\n      const denominator = this.combinations(totalUnknown, drawSize);\r\n      const numerator = this.combinations(totalUnknown - unknownOfRank, drawSize);\r\n\r\n      if (denominator <= 0) {\r\n        result.set(rank, 0);\r\n        continue;\r\n      }\r\n\r\n      result.set(rank, 1 - (numerator / denominator));\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  private combinations(n: number, k: number): number {\r\n    if (k < 0 || k > n) {\r\n      return 0;\r\n    }\r\n\r\n    if (k === 0 || k === n) {\r\n      return 1;\r\n    }\r\n\r\n    const kk = Math.min(k, n - k);\r\n    let result = 1;\r\n\r\n    for (let i = 1; i <= kk; i += 1) {\r\n      result = (result * (n - kk + i)) / i;\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n","import { Card } from '../models/card.model';\n\nexport function findCombinations(targetSum: number, tableCards: Card[]): Card[][] {\n  if (targetSum <= 0 || tableCards.length === 0) {\n    return [];\n  }\n\n  // Scopa rule: if cards with exact same rank exist on table, capture must be among those.\n  const exactMatches = tableCards.filter((card) => card.rank === targetSum);\n  if (exactMatches.length > 0) {\n    return exactMatches.map((card) => [card]);\n  }\n\n  const combinations: Card[][] = [];\n  const n = tableCards.length;\n  const maxMask = 1 << n;\n\r\n  for (let mask = 1; mask < maxMask; mask += 1) {\r\n    let sum = 0;\r\n    const subset: Card[] = [];\r\n\r\n    for (let i = 0; i < n; i += 1) {\r\n      if ((mask & (1 << i)) === 0) {\r\n        continue;\r\n      }\r\n\r\n      const card = tableCards[i];\r\n      subset.push(card);\r\n      sum += card.rank;\r\n    }\r\n\r\n    if (sum === targetSum) {\r\n      combinations.push(subset);\r\n    }\r\n  }\r\n\r\n  return combinations;\r\n}\r\n","export const environment = {\n  production: false,\n  openaiProxyUrl: '/api/openai/suggestion'\n};\n","import { bootstrapApplication } from '@angular/platform-browser';\r\nimport { appConfig } from './app/app.config';\r\nimport { AppComponent } from './app/app.component';\r\n\r\nbootstrapApplication(AppComponent, appConfig)\r\n  .catch((err) => console.error(err));\r\n"],"names":["CommonModule","combineLatest","map","CardGridComponent","ToolbarComponent","StatsPanelComponent","HandSelectorComponent","AISuggestionPanelComponent","LogBarComponent","CARD_BY_ID","CardState","GamePhase","findCombinations","i0","elementStart","text","elementEnd","listener","AppComponent_div_7_Template_app_card_grid_cardClicked_4_listener","$event","restoredCtx","restoreView","_r4","tableVm_r2","ngIf","ctx_r3","nextContext","resetView","onTableCardClicked","phase","element","advance","property","cardStates","probabilities","selectableCardIds","AppComponent","constructor","gameStateService","probabilityService","aiSuggestionService","gamePhase","phase$","tableVm$","state","probabilities$","pipe","probabilityRecord","rank","get","buildSelectableSet","cardId","CHOOSE_COMBINATION","selectCombinationCard","clickTableCard","selectable","Set","INITIAL_FOUR","cardState","Object","entries","UNKNOWN","ON_TABLE","add","PLAYING","turn","IN_MY_HAND","pendingPlayedCard","pendingCard","tableCards","cardsOnTable","id","filter","card","validCombinations","combination","selectedCombination","directiveInject","i1","GameStateService","i2","ProbabilityService","i3","AISuggestionService","selectors","standalone","features","StandaloneFeature","decls","vars","consts","template","AppComponent_Template","rf","ctx","template","AppComponent_div_5_Template","AppComponent_div_7_Template","pipeBind1","i4","NgIf","AsyncPipe","styles","provideHttpClient","provideRouter","routes","appConfig","providers","aiSuggestion$","aiSuggestion","aiLoading$","aiLoading","apiConfigured","isApiConfigured","manualQuery","AISuggestionPanelComponent_Template","AISuggestionPanelComponent_div_3_Template","AISuggestionPanelComponent_p_5_Template","AISuggestionPanelComponent_Template_button_click_9_listener","textInterpolate","EventEmitter","classProp","ctx_r0","textInterpolate1","subText","CardCellComponent","probability","mode","blockedCapture","clicked","onClick","PLAYED","emit","mainText","Math","round","showSubText","inputs","outputs","CardCellComponent_Template","CardCellComponent_Template_button_click_0_listener","CardCellComponent_span_3_Template","ON_TABLE_BLINKING","COMBINATION_CANDIDATE","RANKS","SUITS","createCardId","suit_r2","elementContainerStart","CardGridComponent_tr_5_td_1_ng_container_1_Template_app_card_cell_clicked_1_listener","_r9","card_r7","ctx_r8","onCardClick","elementContainerEnd","ctx_r6","getState","getProbability","rank_r3","isSelectable","CardGridComponent_tr_5_td_1_ng_container_1_Template","ctx_r4","getCard","suit_r5","CardGridComponent_tr_5_td_1_Template","ctx_r1","suits","trackBySuit","cardClicked","ranks","trackByRank","_","suit","has","CardGridComponent_Template","CardGridComponent_th_3_Template","CardGridComponent_tr_5_Template","NgForOf","HandSelectorComponent_div_0_Template_app_card_grid_cardClicked_3_listener","_r3","ctx_r2","onCardClicked","vm_r1","myHandCount","emptyProbabilities","tmp_4_0","undefined","initialPhase","vm$","myHand","length","clickHandCard","HandSelectorComponent_Template","HandSelectorComponent_div_0_Template","logText$","lastPlayLog","value","LogBarComponent_Template","Suit","stats_r1","denariPlayed","coppePlayed","spadePlayed","bastoniPlayed","totalPlayed","remaining","myCaptured","opponentCaptured","phaseLabel","stats$","playedIds","Denari","Coppe","Spade","Bastoni","myCapturedCards","opponentCapturedCards","toPhaseLabel","StatsPanelComponent_Template","StatsPanelComponent_div_0_Template","ToolbarComponent_div_0_Template_button_click_1_listener","cycleOpponentCards","opponent","ToolbarComponent_div_0_Template_button_click_3_listener","reset","ToolbarComponent_div_0_Template_button_click_5_listener","ctx_r5","undo","ToolbarComponent_div_0_Template_button_click_7_listener","setTurn","ToolbarComponent_div_0_Template_button_click_9_listener","ctx_r7","canUndo","opponentCardCount$","opponentCardCount","turn$","canUndo$","history","current","next","setOpponentCardCount","confirmed","window","confirm","ToolbarComponent_Template","ToolbarComponent_div_0_Template","pureFunction3","_c0","toLowerCase","ALL_CARDS","flatMap","reduce","acc","Subject","debounceTime","distinctUntilChanged","finalize","of","switchMap","takeUntil","tap","catchError","environment","openAiService","destroy$","latestState","latestProbabilities","Map","key","buildTriggerKey","a","b","executeQuery","subscribe","ngOnDestroy","complete","endpoint","openaiProxyUrl","trim","setAiLoading","setAiSuggestion","input","buildQueryInput","queryBestMove","suggestion","probabilitiesByRank","playedStates","playedCards","cardLabel","unknownCardsCount","values","legalMoves","buildLegalMove","move","probabilityVector","Array","from","index","JSON","stringify","rankLabel","toString","playedCard","captures","inject","OpenAIService","factory","fac","providedIn","CardTrackerService","handleTableCardClick","snapshot","errorResult","didMutate","handleInitialFour","okResult","handlePlay","handleCombinationSelection","includes","pending","selectedCards","selectedSum","tableCard","isValidSelection","matchesAnyCombination","selectedId","recordCapture","actor","actorLabel","selectedLabel","join","error","shouldToggleTurn","shouldDecrementOpponent","initialFourCount","max","isMyPlay","combinations","combo","comboIds","comboId","capturedLabel","selectedIds","selectedKey","sort","some","comboKey","playedCardId","capturedIds","target","merged","unique","message","BehaviorSubject","cardTracker","localStorageService","storageKey","stateSubject","createInitialState","asObservable","restoreState","getCurrentState","commit","previous","restored","cloneSnapshot","slice","applyMutation","draft","setTurnWithOpponentRefill","toggleTurn","nextTurn","result","nextValue","clamp","decrementOpponentCards","loading","mutator","cloneState","push","toSnapshot","save","loaded","load","normalizeState","raw","normalizeSnapshot","historyRaw","isArray","item","initial","createInitialSnapshot","validStates","phaseValues","uniqueIds","ids","previousTurn","isHandRefillTurnChange","min","LocalStorageService","prefix","data","localStorage","setItem","buildKey","getItem","parse","remove","removeItem","http","post","response","HttpClient","shareReplay","computeProbabilities","bufferSize","refCount","unknownByRank","set","totalUnknown","drawSize","unknownOfRank","denominator","numerator","n","k","kk","i","targetSum","exactMatches","maxMask","mask","sum","subset","production","bootstrapApplication","catch","err","console"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}